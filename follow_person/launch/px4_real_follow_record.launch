<?xml version="1.0"?>
<launch>
    <rosparam command="load" file="$(find follow_person)/config/px4_real.conf" />

    <!--    Drone model param   -->
    <arg name="drone_model" default="px4_real"/>
    <param name="drone_model" type="str" value="$(arg drone_model)" />

    <!-- Image Post-processed-->
    <arg name="image_yolo" default="/brain/yolo_output/image_raw"/>
    <arg name="image_cmd" default="/brain/cmd_response/image_raw"/>

    <!--<include file="$(eval env('PWD) + '/../px4_real/launch/px4_real.launch')">
        <arg name="camera" value="$(arg drone_model)/cam_frontal/image_raw"/>
    </include>-->

    <arg name="fcu_url" default="/dev/ttyUSB0:57600" />
    <arg name="gcs_url" default="" />
    <arg name="tgt_system" default="1" />
    <arg name="tgt_component" default="1" />
    <arg name="log_output" default="screen" />
    <arg name="fcu_protocol" default="v2.0" />
    <arg name="respawn_mavros" default="false" />

    <include file="$(find mavros)/launch/node.launch">
        <arg name="pluginlists_yaml" value="$(find mavros)/launch/px4_pluginlists.yaml" />
        <arg name="config_yaml" value="$(find mavros)/launch/px4_config.yaml" />

        <arg name="fcu_url" value="$(arg fcu_url)" />
        <arg name="gcs_url" value="$(arg gcs_url)" />
        <arg name="tgt_system" value="$(arg tgt_system)" />
        <arg name="tgt_component" value="$(arg tgt_component)" />
        <arg name="log_output" value="$(arg log_output)" />
        <arg name="fcu_protocol" value="$(arg fcu_protocol)" />
        <arg name="respawn_mavros" default="$(arg respawn_mavros)" />
    </include>

    <param name="/mavros/conn/timesync_rate" value="0.0"/>

    <arg name="camera" default="/px4_real/cam_frontal/image_raw"/>
    <param name="victure_topic" type="str" value="$(arg camera)"/>
    <node pkg="victure_driver" type="video_bridge.py" name="victure_cam" output="screen"/>
    
<!--
    <node name="image_view_yolo" pkg="image_view" type="image_view">
        <remap from="image" to="$(arg image_yolo)"/>
    </node>
    <node name="image_view_cmd" pkg="image_view" type="image_view">
        <remap from="image" to="$(arg image_cmd)"/>
    </node>
-->

    <!--<arg name="perspective" default="$(find follow_person)/perspectives/follow_person.perspective"/>
    <node name="rqt_gui" pkg="rqt_gui" type="rqt_gui" respawn="false" output="screen" args="-perspective-file $(arg perspective)"/>-->
    <node pkg="rosbag" type="record" name="recorder" args="-a -p"/>
</launch>
